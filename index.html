<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Carte des logements</title>

    <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css">

    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
        }
        #map {
            height: 100vh;
            width: 100vw;
        }
    </style>
</head>
<body>

<div id="map"></div>

<script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>

<!-- üîµ TON CODE JS COMMENCE ICI -->
<script>

// -------------------------
// Initialisation de la carte
// -------------------------
let map = L.map('map').setView([48.43, -71.06], 13);

L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    maxZoom: 20
}).addTo(map);

// -------------------------
// Afficher les coordonn√©es au clic
// -------------------------
map.on("click", function(e) {
    console.log("Coordonn√©es cliqu√©es :", e.latlng);
    alert("Coordonn√©es : " + e.latlng.lat + ", " + e.latlng.lng);
});

// -------------------------
// Fonction pour tracer un b√¢timent via Overpass
// -------------------------
function tracerBatiment(lat, lon) {
    const query = `
        [out:json][timeout:10];
        way["building"](around:80,${lat},${lon});
        out geom;
    `;

    fetch("https://overpass-api.de/api/interpreter", {
        method: "POST",
        body: query
    })
    .then(r => r.json())
    .then(data => {
        if (!data.elements || data.elements.length === 0) {
            console.log("Aucun b√¢timent trouv√© autour de ce point.");
            return;
        }

        const bat = data.elements[0];
        const coords = bat.geometry.map(p => [p.lat, p.lon]);

        const poly = L.polygon(coords, {
            color: "red",
            weight: 3,
            fillOpacity: 0.3
        }).addTo(map);

        map.fitBounds(poly.getBounds());
    });
}

// -------------------------
// Exemple : tracer le b√¢timent (√† remplacer par les bonnes coordonn√©es)
// -------------------------
tracerBatiment(48.42812, -71.06891);

</script>
<!-- üîµ TON CODE JS FINIT ICI -->

</body>
</html>
